<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Upload and Email Images</title>
</head>
<body style="font-family: Arial, sans-serif; padding: 20px;">
  <h2>Upload Images</h2>

  <input type="file" id="imageInput" accept="image/*" multiple capture="environment">
  <br><br>
  <button onclick="sendImages()">Send to Email</button>

  <p id="status" style="margin-top: 20px;"></p>

  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script>
    emailjs.init("g42tnmFpURrlkWGUF"); // Your public key

    async function sendImages() {
      const input = document.getElementById('imageInput');
      const files = input.files;
      const status = document.getElementById('status');
      if (!files.length) {
        status.innerText = 'Please select image(s).';
        return;
      }

      status.innerText = 'Uploading...';

      const uploadedLinks = [];

      for (const file of files) {
        const formData = new FormData();
        formData.append('file', file);
        formData.append('token', 'gofile');

        try {
          const response = await fetch('https://store1.gofile.io/uploadFile', {
            method: 'POST',
            body: formData
          });

          const result = await response.json();
          if (result.status === 'ok') {
            uploadedLinks.push(result.data.downloadPage);
          }
        } catch (error) {
          console.error('Upload failed:', error);
        }
      }

      if (uploadedLinks.length === 0) {
        status.innerText = 'Upload failed. Try again.';
        return;
      }

      const emailParams = {
        images: uploadedLinks.join("<br>")
      };

      emailjs.send("service_anlae55", "template_xxka83q", emailParams)
        .then(() => {
          status.innerText = 'Images sent to your email!';
        })
        .catch((err) => {
          console.error('Email send error:', err);
          status.innerText = 'Failed to send email.';
        });
    }
  </script>
</body>
</html>
